name: Make Release
on:
  workflow_dispatch:
    inputs:
      tag:
        description: 'Tag (e.g., v0.1.0)'
        required: true
      title:
        description: 'Release title'
        required: true
        default: 'Zaxor Vane Filters'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Ensure dist exists
        run: |
          mkdir -p dist
          [ -f dist/filters.json ] || cat > dist/filters.json <<'EOF'
          {
            "focus": ["military", "cyber", "blackout", "blockade", "sanctions", "anomaly"],
            "avoid": ["celebrity gossip", "sports drama"],
            "whitelist_sources": ["Reuters","DW","BBC","AP","Al Jazeera","ZeroHedge","Grayzone","MintPress"],
            "boost": ["breaking","leak","satellite","troop movement","energy grid","currency swap"]
          }
          EOF

      - name: Create Git tag
        run: |
          git tag ${{ inputs.tag }}
          git push origin ${{ inputs.tag }}

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ inputs.tag }}
          name: ${{ inputs.title }}
          files: dist/filters.json
